# Project Guidelines

## Scope
- Репозиторий — **многомодульный Android‑проект** на Kotlin.
- Цель изменений — расширение функциональности без нарушения существующих контрактов.
- Архитектура базируется на принципах **FSD (Feature‑Sliced Design)**, адаптированных под мобильную разработку.

## Структура проекта
- Gradle multi‑module: `:app`, `:features:*`, `:ui`, `:shared`, `:navigation`.
- Build Tool: **Gradle 8+** с использованием **Kotlin DSL** (`build.gradle.kts`).
- Convention Plugins используются для переиспользования конфигураций, зависимостей и версий.

## Архитектура
- **Feature‑Sliced Design (FSD)**
    - Код во фичах делится на FSD‑слои: `screens` (Pages), `fragments` (Widgets/Features), `entities`, `shared`, `app`.
    - **Screens**: основные пользовательские точки входа (экраны).
    - **Fragments**: переиспользуемые UI‑блоки фичи (аналог Widget/Feature UI сегментов в FSD).
    - **Entities**: модели, константы, API/мапперы, относящиеся к фиче.
    - **Shared**: утилиты и ошибки, специфичные для фичи (shared‑код на уровне фичи).
    - **App**: DI и навигация фичи.
    - Зависимости строго направленные: `screens` → `fragments` → `entities` → `shared`.
    - Нельзя делать циклические или горизонтальные импорты между фичами/срезами.
- **DI (Dependency Injection)**: строго через **Koin**.
- **Сетевой слой**: основа — **Apollo GraphQL**; REST допустим только для медиа или сторонних интеграций.
- **UI**: Jetpack Compose

## Новые модули (Features)
- Каждый новый модуль в `features/` обязан:
    - Иметь чёткую область ответственности.
    - Следовать **FSD‑правилам** разделения на слои.
    - Использовать существующие UI‑примитивы из `:ui` и `:shared-ui`.
    - Подключаться в `settings.gradle.kts` или `gradleSettings/modules.gradle.kts` (если используется) через `:features:<name>`

## Тесты
- Используется **Kotlin tests** (`kotlin.test`) как основной фреймворк для модульных тестов в KMM/Kotlin.
- Покрытие рекомендуется для логики внутри фич.
- Перед финальной сборкой:
    - Проект должен успешно собираться (`./gradlew assembleDebug` / `assembleRelease`).
    - Все тесты должны проходить.

## Code Style
- **Магические значения** выносить в константы (например, в `config/Constants.kt`).
- **Повторяющийся код** выносить в отдельные функции/методы.
- **Один класс/функция — один файл**; не держать несколько функций/классов в одном файле.
- **Плоские нейминги:** если путь уже содержит название фичи/контекста, **не дублировать его в имени файла**.
  Например, `features/profile/fragments/editing/Fragment.kt` — файл просто `Fragment.kt`.
- **Не писать комментарии в коде.**
- **Логировать можно только при дебаге.**
- Строки должны быть в `strings.xml`.
- Цвета и шрифты должны браться строго из темы (`ui/theme/Theme.kt`).
- Имена файлов начинаются строго с большой буквы

## Что запрещено
- Ломать публичные API существующих модулей.
- Добавлять тяжёлые зависимости без согласования.
- Игнорировать **FSD‑правила** зависимостей.
- Смешивать логику между модулями напрямую — использовать API.

## Поведение Junie
1. **Анализ**: сначала изучить структуру аналогичных фич.
2. **Минимализм**: вносить только необходимые изменения.
3. **Аргументация**: объяснять архитектурные изменения.
4. **Тестирование**: после выполнения задачи собирать проект и прогонять тесты 
